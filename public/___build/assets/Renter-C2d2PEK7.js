import{S as b}from"./sweetalert2-z6gKu1nJ.js";import{a as u}from"./axios-B4uVmeYG.js";import{M as V,t as R,d as E,m as N,N as U,c as F,i as S,f as w}from"./utils-B-CemkDS.js";import{r as C,i as I,o as l,c as n,a as e,t as a,j as i,v as r,k,F as m,h,b as _,m as B,w as v,e as g}from"./app-e3q45BkK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={data:function(){return{data:{},renter:{income:"",income_proof:"",address_proof:"",rg:"",cpf:"",id_people:"",id_people:"",people:{name:"",surname:"",cpf:"",rg:"",cep:"",cellphone:"",email:"",address:"",complement:"",number:"",marital_status:"",birth_date:"",district:"",id_city:"",profession:""}},cities:{},config:{decimal:",",thousands:".",prefix:"R$ ",precision:2,masked:!1},documents:[],marital_status:V,transaction_type:R,contract_status:E,modality:N,handleFileUpload:U,onError:F,isNumber:S,formatDate:w,send_cpf:!1,send_rg:!1,send_address:!1,send_income:!1,transaction:{},accounts:{},transactions:{},total_security_deposit:"",total_property_damage:0,deposit_modality:!1}},methods:{getRenter(){u.get("/renters/"+this.$route.params.id).then(t=>{this.renter=t.data.renter,this.renter.id&&this.extractTransactions()}).catch(t=>{console.error("Houve um problema com a requisição:",t)})},extractTransactions(){if(this.renter&&this.renter.transaction&&this.renter.transaction.length>0){this.transactions=this.renter.transaction;const t=this.renter.transaction[0].id_property;this.getAccountsSecurityByIdRenter(t),this.sumSecurityDeposits(),this.hasDepositModality()}else this.transaction={}},saveRenter(){this.handlesSpecialCharacters(),this.documents.length>0&&(this.renter.documents=this.documents),u.post("/renters",this.renter).then(t=>{b.fire({position:"top-end",icon:"success",title:t.data.message,showConfirmButton:!1,timer:2500}),this.$router.go(-1)}).catch(t=>{t&&t.response.data.errors?t=this.onError(t):t=t.response.data,b.fire({position:"top-end",icon:"error",title:t.message,showConfirmButton:!1,timer:2500})})},updateRenter(){this.handlesSpecialCharacters(),this.documents.length>0&&(this.locator.documents=this.documents),u.put("/renters/"+this.$route.params.id,this.renter).then(t=>{b.fire({position:"top-end",icon:"success",title:t.data.message,showConfirmButton:!1,timer:2500}),this.$router.go(-1)}).catch(t=>{b.fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:2500})})},getCities(){u.get("/cities",{}).then(t=>{this.cities=t.data.cities}).catch(t=>{console.error("Houve um problema com a requisição:",t)})},back(){this.$router.go(-1)},handlesSpecialCharacters(){this.renter.people.cpf=this.renter.people.cpf!=null?this.renter.people.cpf.replace(/[.\-\s()]/g,""):"",this.renter.people.rg=this.renter.people.rg!=null?this.renter.people.rg.replace(/[.\-\s()]/g,""):"",this.renter.people.cellphone=this.renter.people.cellphone!=null?this.renter.people.cellphone.replace(/[.\-\s()]/g,""):"",this.renter.people.cep=this.renter.people.cep!=null?this.renter.people.cep.replace(/[.\-\s()]/g,""):""},getPeopleByCpf(t){let o=t.target.value;if(o=o!=null?o.replace(/[.\-\s()]/g,""):null,!o)return!1;u.get("/people/"+this.$route.params.id+"/get-by-cpf",{params:{cpf:o}}).then(p=>{p.data.people&&(this.renter.id_people=p.data.people.id,this.renter.people=p.data.people,this.renter.people_exists=!0)}).catch(p=>{console.error("Houve um problema com a requisição:",p)})},clearFilter(){this.$router.go()},validateDocument(t){return this.renter.people.documents?this.renter.people.documents.some(p=>p.type_document===t):!1},getAccountsSecurityByIdRenter(t){u.get("/accounts-pay",{params:{type:1,status:2,category:6,id_property:t,id_casher:!0}}).then(o=>{this.accounts=o.data.accounts.data,this.accounts.length>0&&this.sumAccounts()}).catch(o=>{console.error("Houve um problema com a requisição:",o)})},sumSecurityDeposits(){this.total_security_deposit=this.transactions.reduce((t,o)=>t+parseFloat(o.security_deposit),0)??"0.00"},sumAccounts(){this.total_property_damage=this.accounts.reduce((t,o)=>t+parseFloat(o.final_value),0)??"0.00"},hasDepositModality(){this.deposit_modality=this.transactions.some(t=>t.modality===2)}},beforeMount(){this.getCities(),this.$route.params.id&&this.getRenter()}},M={class:"container-fluid"},A={class:"col-md-12"},T=e("h2",null,"Locatário",-1),L={class:"card card-primary"},q={class:"card-header"},H={class:"card-title"},G={class:"card-body"},j={class:"row"},K={class:"col-sm-3"},z={class:"form-group"},J=e("label",{for:"inputName"},"Nome",-1),O=["disabled"],Q={class:"col-sm-3"},W={class:"form-group"},X=e("label",{for:"inputSurname"},"Sobrenome",-1),Y=["disabled"],Z={class:"col-sm-3"},x={class:"form-group"},ee=e("label",{for:"inputBirthDate"},"Dt. Nascimento",-1),te=["disabled"],se={class:"col-sm-3"},oe={class:"form-group"},le=e("label",{for:"inputMaritalStatus"},"Estado Civil",-1),ne=["disabled"],ae=e("option",{value:""},"Selecione Estado Civil",-1),ie=["id","value"],re={class:"row"},de={class:"col-sm-3"},pe={class:"form-group"},ce=e("label",{for:"inputCpf"},"CPF",-1),ue=["disabled"],me={class:"col-sm-3"},he=e("label",{class:"form-label",for:"customFile"},"Comprovante de CPF",-1),_e=e("br",null,null,-1),fe={key:0},be=e("label",null,"Comprovante Enviado",-1),ve=e("i",{class:"fas fa-upload"},null,-1),ye=[ve],ge=["disabled"],Ce={class:"col-sm-3"},ke={class:"form-group"},De=e("label",{for:"inputRg"},"RG",-1),Ve=["disabled"],Re={class:"col-sm-3"},Ee=e("label",{class:"form-label",for:"customFile"},"Comprovante de RG",-1),Ne=e("br",null,null,-1),Ue={key:0},Fe=e("label",null,"Comprovante Enviado",-1),Se=e("i",{class:"fas fa-upload"},null,-1),we=[Se],Ie=["disabled"],Be={class:"row"},$e={class:"col-sm-3"},Pe={class:"form-group"},Me=e("label",{for:"inputCellphone"},"Celular",-1),Ae=["disabled"],Te={class:"col-sm-3"},Le={class:"form-group"},qe=e("label",{for:"inputEmail"},"Email",-1),He=["disabled"],Ge={class:"col-sm-4"},je={class:"form-group"},Ke=e("label",{for:"inputAddress"},"Endereço",-1),ze=["disabled"],Je={class:"col-sm-2"},Oe={class:"form-group"},Qe=e("label",{for:"inputNumber"},"Número",-1),We=["disabled"],Xe={class:"row"},Ye={class:"col-sm-2"},Ze={class:"form-group"},xe=e("label",{for:"inputDistrict"},"Bairro",-1),et=["disabled"],tt={class:"col-sm-3"},st={class:"form-group"},ot=e("label",{for:"inputComplement"},"Complemento",-1),lt=["disabled"],nt={class:"col-sm-2"},at={class:"form-group"},it=e("label",{for:"inputIdCity"},"Cidade",-1),rt=["disabled"],dt=e("option",{value:""},"Selecione a Cidade",-1),pt=["id","value"],ct={class:"col-sm-2"},ut={class:"form-group"},mt=e("label",{for:"inputCep"},"CEP",-1),ht=["disabled"],_t={class:"col-sm-3"},ft=e("label",{class:"form-label",for:"customFile"},"Comprovante de Residência",-1),bt=e("br",null,null,-1),vt={key:0},yt=e("label",null,"Comprovante Enviado",-1),gt=e("i",{class:"fas fa-upload"},null,-1),Ct=[gt],kt=e("div",{class:"row"},[e("div",{class:"col-sm-12"},[e("div",{class:"card-footer"})])],-1),Dt={class:"row"},Vt={class:"col-sm-3"},Rt={class:"form-group"},Et=e("label",{for:"inputProfession"},"Profissão",-1),Nt={class:"col-sm-3"},Ut={class:"form-group"},Ft=e("label",{for:"inputIncome"},"Renda Mensal",-1),St={class:"input-group"},wt=e("div",{class:"input-group-prepend"},[e("span",{class:"input-group-text"},[e("i",{class:"fas fa-dollar-sign"})])],-1),It={class:"col-sm-6"},Bt=e("label",{class:"form-label",for:"customFile"},"Comprovante de Renda",-1),$t=e("br",null,null,-1),Pt={key:0},Mt=e("label",null,"Comprovante Enviado",-1),At=e("i",{class:"fas fa-upload"},null,-1),Tt=[At],Lt=e("div",{class:"row"},[e("div",{class:"row"},[e("div",{class:"col-sm-12"},[e("div",{class:"card-footer"})])])],-1),qt={class:"modal-footer justify-content-center"},Ht={key:0,class:"card card-primary"},Gt={class:"card-header"},jt={class:"card-title"},Kt={class:"card-body"},zt={class:"scrollable text-left"},Jt={class:"table table-head-fixed text-nowrap text-left"},Ot=e("thead",null,[e("tr",null,[e("th",{class:"md='auto'"},"Referência"),e("th",{class:"md='auto'"},"Transação"),e("th",{class:"md='auto'"},"Status do Contrato"),e("th",{class:"md='auto'"},"Modalidade"),e("th",{class:"md='auto'"},"Proprietário do Imóvel"),e("th",{class:"md='auto'"},"Ver Proprietário"),e("th",{class:"md='auto'"},"Ver Imóvel"),e("th",{class:"md='auto'"},"Ver Transação")])],-1),Qt=e("button",{type:"button",class:"btn btn-outline-primary",style:{"margin-top":"-0.5em"}},[e("i",{class:"fas fa-solid fa-eye"})],-1),Wt=e("button",{type:"button",class:"btn btn-outline-primary",style:{"margin-top":"-0.5em"}},[e("i",{class:"fas fa-solid fa-eye"})],-1),Xt=e("button",{type:"button",class:"btn btn-outline-primary",style:{"margin-top":"-0.5em"}},[e("i",{class:"fas fa-solid fa-eye"})],-1),Yt={key:1,class:"card card-primary"},Zt=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"Avarias no Imóvel")],-1),xt={class:"card-body"},es={class:"scrollable text-left"},ts={class:"table table-head-fixed text-nowrap text-left"},ss=e("thead",null,[e("tr",null,[e("th",{class:"md='auto'"},"ID"),e("th",{class:"md='auto'"},"Descrição"),e("th",{class:"md='auto'"},"Data de Compensação"),e("th",{class:"md='auto'"},"Valor"),e("th",{class:"md='auto'"},"Ver Conta")])],-1),os=e("button",{type:"button",class:"btn btn-outline-primary",style:{"margin-top":"-0.5em"}},[e("i",{class:"fas fa-solid fa-eye"})],-1),ls={key:2,class:"card card-primary"},ns=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"Caução")],-1),as={class:"card-body"},is={class:"scrollable text-left"},rs={class:"table table-head-fixed text-nowrap text-left"},ds=e("thead",null,[e("tr",null,[e("th",{class:"md='auto'"},"Referência"),e("th",{class:"md='auto'"},[e("b",null,"Total Caução")]),e("th",{class:"md='auto'"},[e("b",null,"Total Avarias")]),e("th",{class:"md='auto'"},[e("b",null,"Restante Caução")]),e("th",{class:"md='auto'"})])],-1),ps={style:{color:"red"}},cs={style:{color:"#f89d52"}};function us(t,o,p,ms,hs,d){const D=C("money3"),f=C("router-link"),y=I("mask");return l(),n("div",M,[e("div",A,[T,e("div",L,[e("div",q,[e("h3",H,a(t.renter.id?"Editar Locatário":"Cadastrar Locatário"),1)]),e("div",G,[e("div",j,[e("div",K,[e("div",z,[J,i(e("input",{type:"text",class:"form-control",id:"inputName",name:"name",disabled:t.renter.people_exists,placeholder:"Informe o Nome",maxlength:"20",value:"","onUpdate:modelValue":o[0]||(o[0]=s=>t.renter.people.name=s)},null,8,O),[[r,t.renter.people.name]])])]),e("div",Q,[e("div",W,[X,i(e("input",{type:"text",class:"form-control",id:"inputSurname",placeholder:"Informe o Sobrenome",name:"surname",maxlength:"70",disabled:t.renter.people_exists,"onUpdate:modelValue":o[1]||(o[1]=s=>t.renter.people.surname=s)},null,8,Y),[[r,t.renter.people.surname]])])]),e("div",Z,[e("div",x,[ee,i(e("input",{type:"date",class:"form-control",id:"inputBirthDate",placeholder:"Informe a Data de Nascimento",name:"birth_date",disabled:t.renter.people_exists,"onUpdate:modelValue":o[2]||(o[2]=s=>t.renter.people.birth_date=s)},null,8,te),[[r,t.renter.people.birth_date]])])]),e("div",se,[e("div",oe,[le,i(e("select",{class:"custom-select",id:"inputMaritalStatus",name:"marital_status",disabled:t.renter.people_exists,"onUpdate:modelValue":o[3]||(o[3]=s=>t.renter.people.marital_status=s)},[ae,(l(!0),n(m,null,h(t.marital_status,(s,c)=>(l(),n("option",{key:c,id:c,value:c},a(s),9,ie))),128))],8,ne),[[k,t.renter.people.marital_status]])])])]),e("div",re,[e("div",de,[e("div",pe,[ce,i(e("input",{type:"text",class:"form-control cpf",id:"inputCpf",name:"cpf",disabled:t.renter.people_exists,onBlur:o[4]||(o[4]=s=>d.getPeopleByCpf(s)),"onUpdate:modelValue":o[5]||(o[5]=s=>t.renter.people.cpf=s),placeholder:"Informe o CPF",masked:"false"},null,40,ue),[[r,t.renter.people.cpf],[y,"###.###.###-##"]])])]),e("div",me,[he,_e,d.validateDocument("cpf")&&!t.send_cpf?(l(),n("div",fe,[be,e("button",{type:"button",class:"btn btn-outline-primary",title:"Enviar Novo Documento",style:{"margin-top":"-0.5em","margin-left":"1em"},onClick:o[6]||(o[6]=s=>t.send_cpf=!0)},ye)])):(l(),n("input",{key:1,class:"form-label",type:"file",id:"cpf_proof",name:"cpf_proof",disabled:t.renter.people_exists,onChange:o[7]||(o[7]=s=>t.handleFileUpload(s,"cpf"))},null,40,ge))]),e("div",Ce,[e("div",ke,[De,i(e("input",{type:"text",class:"form-control cpf",id:"inputRg",name:"rg",maxlength:"11",disabled:t.renter.people_exists,"onUpdate:modelValue":o[8]||(o[8]=s=>t.renter.people.rg=s),placeholder:"Informe o RG",onKeypress:o[9]||(o[9]=s=>t.isNumber(s))},null,40,Ve),[[r,t.renter.people.rg]])])]),e("div",Re,[Ee,Ne,d.validateDocument("rg")&&!t.send_rg?(l(),n("div",Ue,[Fe,e("button",{type:"button",class:"btn btn-outline-primary",title:"Enviar Novo Documento",style:{"margin-top":"-0.5em","margin-left":"1em"},onClick:o[10]||(o[10]=s=>t.send_rg=!0)},we)])):(l(),n("input",{key:1,class:"form-label",type:"file",id:"rg_proof",name:"rg_proof",disabled:t.renter.people_exists,onChange:o[11]||(o[11]=s=>t.handleFileUpload(s,"rg"))},null,40,Ie))])]),e("div",Be,[e("div",$e,[e("div",Pe,[Me,i(e("input",{type:"text",class:"form-control",id:"inputCellphone",name:"cellphone",disabled:t.renter.people_exists,"onUpdate:modelValue":o[12]||(o[12]=s=>t.renter.people.cellphone=s),placeholder:"Informe o Celular",masked:"false"},null,8,Ae),[[r,t.renter.people.cellphone],[y,["(##) ####-####","(##) #####-####"]]])])]),e("div",Te,[e("div",Le,[qe,i(e("input",{type:"text",class:"form-control",id:"inputEmail",maxlength:"40",disabled:t.renter.people_exists,"onUpdate:modelValue":o[13]||(o[13]=s=>t.renter.people.email=s),name:"email",placeholder:"Informe o Email"},null,8,He),[[r,t.renter.people.email]])])]),e("div",Ge,[e("div",je,[Ke,i(e("input",{type:"text",class:"form-control",id:"inputAddress",disabled:t.renter.people_exists,"onUpdate:modelValue":o[14]||(o[14]=s=>t.renter.people.address=s),placeholder:"Digite o Endereço",name:"address",maxlength:"100"},null,8,ze),[[r,t.renter.people.address]])])]),e("div",Je,[e("div",Oe,[Qe,i(e("input",{type:"text",class:"form-control",id:"inputNumber","onUpdate:modelValue":o[15]||(o[15]=s=>t.renter.people.number=s),disabled:t.renter.people_exists,placeholder:"No.",name:"number",maxlength:"11",onKeypress:o[16]||(o[16]=s=>t.isNumber(s))},null,40,We),[[r,t.renter.people.number]])])])]),e("div",Xe,[e("div",Ye,[e("div",Ze,[xe,i(e("input",{type:"text",class:"form-control",id:"inputDistrict",disabled:t.renter.people_exists,"onUpdate:modelValue":o[17]||(o[17]=s=>t.renter.people.district=s),placeholder:"Digite o Bairro",maxlength:"50",name:"district"},null,8,et),[[r,t.renter.people.district]])])]),e("div",tt,[e("div",st,[ot,i(e("input",{type:"text",class:"form-control",id:"inputComplement",disabled:t.renter.people_exists,"onUpdate:modelValue":o[18]||(o[18]=s=>t.renter.people.complement=s),placeholder:"Digite o Complemento",name:"complement",maxlength:"100"},null,8,lt),[[r,t.renter.people.complement]])])]),e("div",nt,[e("div",at,[it,i(e("select",{class:"custom-select",id:"inputIdCity",name:"id_city",disabled:t.renter.people_exists,"onUpdate:modelValue":o[19]||(o[19]=s=>t.renter.people.id_city=s)},[dt,(l(!0),n(m,null,h(t.cities,(s,c)=>(l(),n("option",{key:c,id:c,value:s.id},a(s.name),9,pt))),128))],8,rt),[[k,t.renter.people.id_city]])])]),e("div",ct,[e("div",ut,[mt,i(e("input",{type:"text",class:"form-control cep",id:"cep",placeholder:"Digite o CEP",disabled:t.renter.people_exists,masked:"false",name:"cep","onUpdate:modelValue":o[20]||(o[20]=s=>t.renter.people.cep=s)},null,8,ht),[[y,"#####-###"],[r,t.renter.people.cep]])])]),e("div",_t,[ft,bt,d.validateDocument("address")&&!t.send_address?(l(),n("div",vt,[yt,e("button",{type:"button",class:"btn btn-outline-primary",title:"Enviar Novo Documento",style:{"margin-top":"-0.5em","margin-left":"1em"},onClick:o[21]||(o[21]=s=>t.send_address=!0)},Ct)])):(l(),n("input",{key:1,class:"form-label",type:"file",id:"address_proof",name:"address_proof",onChange:o[22]||(o[22]=s=>t.handleFileUpload(s,"address"))},null,32))])]),kt,e("div",Dt,[e("div",Vt,[e("div",Rt,[Et,i(e("input",{type:"text",class:"form-control",id:"inputProfession",maxlength:"40","onUpdate:modelValue":o[23]||(o[23]=s=>t.renter.people.profession=s),name:"profession",placeholder:"Informe a Profissão"},null,512),[[r,t.renter.people.profession]])])]),e("div",Nt,[e("div",Ut,[Ft,e("div",St,[wt,_(D,B({class:"form-control",modelValue:t.renter.income,"onUpdate:modelValue":o[24]||(o[24]=s=>t.renter.income=s)},t.config,{id:"inputIncome",placeholder:"Valor da Renda",name:"sale_value"}),null,16,["modelValue"])])])]),e("div",It,[Bt,$t,d.validateDocument("income")&&!t.send_income?(l(),n("div",Pt,[Mt,e("button",{type:"button",class:"btn btn-outline-primary",title:"Enviar Novo Documento",style:{"margin-top":"-0.5em","margin-left":"1em"},onClick:o[25]||(o[25]=s=>t.send_income=!0)},Tt)])):(l(),n("input",{key:1,class:"form-label",type:"file",id:"income_proof",name:"income_proof",onChange:o[26]||(o[26]=s=>t.handleFileUpload(s,"income"))},null,32))])]),Lt,e("div",qt,[t.renter.id?(l(),n("button",{key:0,type:"submit",class:"btn btn-primary",onClick:o[27]||(o[27]=s=>d.updateRenter())}," Atualizar ")):(l(),n("button",{key:1,type:"submit",class:"btn btn-primary",onClick:o[28]||(o[28]=s=>d.saveRenter())}," Salvar ")),e("button",{class:"btn btn-danger",onClick:o[29]||(o[29]=s=>d.back())},"Voltar"),e("button",{onClick:o[30]||(o[30]=s=>d.clearFilter()),class:"btn btn-secondary"},"Limpar")])])]),t.renter.transaction&&t.renter.transaction.length>=1?(l(),n("div",Ht,[e("div",Gt,[e("h3",jt,"Imóvel associado à "+a(t.renter.people.name),1)]),e("div",Kt,[e("div",zt,[e("table",Jt,[Ot,e("tbody",null,[(l(!0),n(m,null,h(t.renter.transaction,s=>(l(),n("tr",{key:s.id},[e("td",null,[e("b",null,a(s.property.reference),1)]),e("td",null,a(t.transaction_type[s.transaction_type]),1),e("td",null,a(t.contract_status[s.contract_status]),1),e("td",null,a(t.modality[s.modality]),1),e("td",null,a(s.locator.people.name+" "+s.locator.people.surname),1),e("td",null,[_(f,{to:"/renter/"+s.id_renter+"/edit",class:"small-box-footer"},{default:v(()=>[Qt]),_:2},1032,["to"])]),e("td",null,[_(f,{to:"/property/"+s.id+"/edit",class:"small-box-footer"},{default:v(()=>[Wt]),_:2},1032,["to"])]),e("td",null,[_(f,{to:"/transaction/"+s.id+"/edit",class:"small-box-footer"},{default:v(()=>[Xt]),_:2},1032,["to"])])]))),128))])])])])])):g("",!0),t.transactions.length>0&&t.accounts.length>0?(l(),n("div",Yt,[Zt,e("div",xt,[e("div",es,[e("table",ts,[ss,e("tbody",null,[(l(!0),n(m,null,h(t.accounts,s=>(l(),n("tr",{key:s.id},[e("td",null,a(s.id),1),e("td",null,a(s.description),1),e("td",null,a(t.formatDate(s.discharge_date)),1),e("td",null,"R$ "+a(s.final_value),1),e("td",null,[_(f,{to:"/account-pay/"+s.id+"/pay-off",class:"small-box-footer"},{default:v(()=>[os]),_:2},1032,["to"])])]))),128))])])])])])):g("",!0),t.transactions&&t.deposit_modality?(l(),n("div",ls,[ns,e("div",as,[e("div",is,[e("table",rs,[ds,e("tbody",null,[(l(!0),n(m,null,h(t.transactions,s=>(l(),n("tr",{key:s.id},[e("th",null,[e("b",null,a(s.property.reference),1)]),e("th",null,[e("b",null,"R$ "+a(t.total_security_deposit?t.total_security_deposit:"0.00"),1)]),e("th",ps,[e("b",null,"R$ "+a(t.total_property_damage?t.total_property_damage:"0.00"),1)]),e("th",cs," R$ "+a(parseFloat(t.total_security_deposit)-parseFloat(t.total_property_damage)),1)]))),128))])])])])])):g("",!0)])])}const gs=$(P,[["render",us]]);export{gs as default};
